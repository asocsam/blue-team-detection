{
  "dashboard": {
    "title": "Credential Abuse Investigation",
    "description": "Visualises failed authentications, MFA bypasses, and GuardDuty findings for rapid triage.",
    "definition": {
      "layout": {
        "type": "grid",
        "options": {
          "width": 1440,
          "height": 900,
          "display": "auto"
        }
      },
      "dataSources": {
        "rdpFailures": {
          "type": "ds.search",
          "options": {
            "query": "`macro_rdp_index` sourcetype=windows:security EventCode=4625 Logon_Type=10 | stats count by src_ip, dest_host",
            "queryParameters": {}
          }
        },
        "mfaBypass": {
          "type": "ds.search",
          "options": {
            "query": "`macro_cloudtrail_index` eventName=ConsoleLogin additionalEventData.MFAUsed=No | stats count by userIdentity.userName, sourceIPAddress",
            "queryParameters": {}
          }
        },
        "guardduty": {
          "type": "ds.search",
          "options": {
            "query": "`macro_guardduty_index` detail.type=* | stats count by detail.type, detail.severity",
            "queryParameters": {}
          }
        }
      },
      "visualizations": {
        "rdpTable": {
          "type": "viz.table",
          "dataSources": {
            "primary": "rdpFailures"
          },
          "title": "Top RDP Failure Sources"
        },
        "mfaMap": {
          "type": "viz.singlevalue",
          "dataSources": {
            "primary": "mfaBypass"
          },
          "title": "MFA-less Console Logins",
          "options": {
            "majorValue": "count"
          }
        },
        "guarddutyBar": {
          "type": "viz.bar",
          "dataSources": {
            "primary": "guardduty"
          },
          "title": "GuardDuty Findings by Type",
          "options": {
            "xField": "detail.type",
            "yField": "count"
          }
        }
      },
      "inputs": {}
    }
  }
}
